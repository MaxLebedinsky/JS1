<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">

    <script>
        // Задание 2 и 3
        'use strict';

        let commonProduct = { // общий прототип продукта
            name: '', // название
            code: 0, // артикул
            category: '', // категория товара
            price: 0, // розничная цена
            businessPrice: 0, // оптовая цена
            stock: 10, // остаток на складе
            available: true, // доступность к покупке
            mainPic: '', // ссылка на основную картинку
            pics: [], // массив ссылок на доп. картинки
            description: '', // описание товара
            discount: 0, // скидка (по умолчанию - 0%)
            amount: 0, // кол-во в корзине
            actionPrice: function () { // подсчёт акционной цены (со скидкой)
                return this.price / 100 * (100 - this.discount)
            }

        }

        function CreateProduct(name, code, price) { // создание продукта с основными свойствами
            this.name = name;
            this.code = code;
            this.price = price;
        }

        CreateProduct.prototype = commonProduct;

        let basket = { // объект корзины
            items: [], // массив позиций корзины

            addItem: function (product) { // добавление товара в корзину
                this.items.push(product);
            },

            displaySubtotals: function () { // вывод содержимого корзины с подытогами по позициям, с учётом скидок; запись подытогов
                for (let i = 0; i < basket.items.length; i++) {
                    basket.items[i].subtotal = basket.items[i].actionPrice() * basket.items[i].amount; // подытог по данной позиции
                    console.log(`Название: ${basket.items[i].name}; Кол-во: ${basket.items[i].amount}; Цена: ${basket.items[i].price}; Скидка: ${basket.items[i].discount}%;  Стоимость: ${basket.items[i].subtotal}`);
                }
            },

            countBasketPrice: function () {
                let total = 0;

                for (let i = 0; i < basket.items.length; i++) {
                    total += basket.items[i].subtotal;
                }

                return total;
            }
        };

        let product1 = new CreateProduct('Burton X', 'brtn-234-018', 500); // создаём экземпляры продуктов
        let product2 = new CreateProduct('Rossignol', 'rsgnl-14-2673', 300);
        let product3 = new CreateProduct('Capita', 'cpt-65-14', 400);

        product1.discount = 10; // для этого продукта прописали скидку 10%; для остальных она прописана в прототипе - 0%

        product1.amount = 2; // допустим, в корзину попало столько единиц товара
        product2.amount = 1;
        product3.amount = 3;

        basket.addItem(product1); // добавляем товары в корзину
        basket.addItem(product2);
        basket.addItem(product3);

        basket.displaySubtotals(); // выводим содержимое корзины с подытогами

        console.log(`ИТОГО: ${basket.countBasketPrice()}`); // выводим общую стоимость корзины


    </script>
</head>

<body>

</body>

</html>